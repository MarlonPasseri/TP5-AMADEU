name: P贸s-Deploy - Testes Selenium

on:
  workflow_run:
    workflows: [ "CD - Deploy em Produ莽茫o" ]
    types:
      - completed

jobs:
  selenium-tests:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout c贸digo
        uses: actions/checkout@v4

      - name: Configurar Java
        uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'

      - name: Instalar Chrome e ChromeDriver
        run: |
          sudo apt-get update
          sudo apt-get install -y chromium-browser chromium-chromedriver

      - name: Rodar testes Selenium (p贸s-deploy)
        run: |
          echo "::group::Iniciando testes Selenium p贸s-deploy "
          ./gradlew seleniumTest --no-daemon -Dapp.baseUrl=${{ github.event.workflow_run.conclusion == 'success' && 'https://minha-app-em-producao.exemplo.com' || 'http://localhost:8080' }}
          echo "::endgroup::"

      - name: Resumo P贸s-Deploy
        if: always()
        run: |
          echo "## Testes P贸s-Deploy И" >> $GITHUB_STEP_SUMMARY
          echo "- Status: ${{ job.status }}" >> $GITHUB_STEP_SUMMARY
